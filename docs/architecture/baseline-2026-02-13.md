# Architecture Baseline (2026-02-13)

Last refreshed: 2026-02-14 (post backend/frontend decomposition, candidate detail tab split, API shim removal, and full-suite validation)

## Scope
- Backend: `/Users/sampatel/tali-platform/backend/app`
- Frontend: `/Users/sampatel/tali-platform/frontend/src`
- Purpose: pre/post-modularization baseline for conflict reduction, readability, and workaround removal.

## Largest Source Files (LOC)

| LOC | File |
|---:|---|
| 919 | `/Users/sampatel/tali-platform/frontend/src/features/candidates/CandidatesUI.jsx` |
| 878 | `/Users/sampatel/tali-platform/frontend/src/features/candidates/CandidateDetailPage.jsx` |
| 860 | `/Users/sampatel/tali-platform/frontend/src/features/assessment_runtime/AssessmentPage.jsx` |
| 843 | `/Users/sampatel/tali-platform/frontend/src/features/tasks/TasksPage.jsx` |
| 716 | `/Users/sampatel/tali-platform/backend/app/components/scoring/scoring_core.py` |
| 547 | `/Users/sampatel/tali-platform/backend/app/components/assessments/submission_runtime.py` |
| 484 | `/Users/sampatel/tali-platform/frontend/src/features/dashboard/DashboardPage.jsx` |
| 474 | `/Users/sampatel/tali-platform/frontend/src/features/settings/SettingsPage.jsx` |
| 430 | `/Users/sampatel/tali-platform/backend/app/components/assessments/service.py` |
| 410 | `/Users/sampatel/tali-platform/frontend/src/features/candidates/CandidatesPage.jsx` |

## Endpoint Decorator Counts

Method decorator count (`@router.get/post/put/patch/delete`):

- `api/v1`: `0` (thin wrappers only)
- `domains/*`: `59`
- `components/*`: `0`

Interpretation:
- Transport assembly moved out of legacy endpoint definitions.
- Canonical HTTP surface is now in `domains/*` with `api/v1` forwarding to domain routers.
- Frontend app shell is route-only and page modules live under `features/*`.
- `/Users/sampatel/tali-platform/frontend/src/App.jsx` reduced from `1779` LOC to `355` LOC.
- Auth pages decomposed into separate feature modules under `/Users/sampatel/tali-platform/frontend/src/features/auth/`.
- `/Users/sampatel/tali-platform/frontend/src/features/candidates/CandidatesPage.jsx` split into container + UI module (`410` + `919` LOC) to reduce same-file conflict pressure.
- `/Users/sampatel/tali-platform/frontend/src/features/candidates/CandidateDetailPage.jsx` split with extracted tab module (`878` + `333` LOC) to reduce same-file conflict pressure.
- Frontend API compatibility shim `/Users/sampatel/tali-platform/frontend/src/lib/api.js` removed; imports now use `/Users/sampatel/tali-platform/frontend/src/shared/api/*`.

## Shim / Re-export Inventory

### Legacy component API modules
- Remaining `components/**/api.py`: `0`
- Removed paths include:
  - `/Users/sampatel/tali-platform/backend/app/components/auth/api.py`
  - `/Users/sampatel/tali-platform/backend/app/components/candidates/api.py`
  - `/Users/sampatel/tali-platform/backend/app/components/tasks/api.py`
  - `/Users/sampatel/tali-platform/backend/app/components/team/api.py`
  - `/Users/sampatel/tali-platform/backend/app/components/organizations/api.py`
  - `/Users/sampatel/tali-platform/backend/app/components/integrations/workable/api.py`
  - `/Users/sampatel/tali-platform/backend/app/components/integrations/stripe/api.py`

### Service shim removals
- Removed shim files:
  - `/Users/sampatel/tali-platform/backend/app/services/access_control_service.py`
  - `/Users/sampatel/tali-platform/backend/app/services/claude_service.py`
  - `/Users/sampatel/tali-platform/backend/app/services/e2b_service.py`
  - `/Users/sampatel/tali-platform/backend/app/services/email_service.py`
  - `/Users/sampatel/tali-platform/backend/app/services/prompt_analytics.py`
  - `/Users/sampatel/tali-platform/backend/app/services/scoring_service.py`
  - `/Users/sampatel/tali-platform/backend/app/services/stripe_service.py`
  - `/Users/sampatel/tali-platform/backend/app/services/workable_service.py`
- Active `services/*.py` modules are now implementation modules plus package init.

### Model/schema wrapper removals
- Removed wrapper files:
  - `/Users/sampatel/tali-platform/backend/app/components/assessments/models.py`
  - `/Users/sampatel/tali-platform/backend/app/components/assessments/schemas.py`
  - `/Users/sampatel/tali-platform/backend/app/components/auth/models.py`
  - `/Users/sampatel/tali-platform/backend/app/components/auth/schemas.py`
  - `/Users/sampatel/tali-platform/backend/app/components/candidates/models.py`
  - `/Users/sampatel/tali-platform/backend/app/components/candidates/schemas.py`
  - `/Users/sampatel/tali-platform/backend/app/components/organizations/models.py`
  - `/Users/sampatel/tali-platform/backend/app/components/organizations/schemas.py`
  - `/Users/sampatel/tali-platform/backend/app/components/tasks/models.py`
  - `/Users/sampatel/tali-platform/backend/app/components/tasks/schemas.py`

## Validation Metrics

### Backend tests
- Command: `cd /Users/sampatel/tali-platform/backend && ./venv/bin/pytest`
- Result: `746 passed, 6 skipped, 26 deselected, 0 failed`.

### Frontend tests
- Command: `cd /Users/sampatel/tali-platform/frontend && npm test`
- Result: `107 passed, 0 failed`.

### Frontend build
- Command: `cd /Users/sampatel/tali-platform/frontend && npm run build`
- Result: build succeeds.
- Current chunks after manual chunking:
  - `dist/assets/index-*.js` ~`109.00 kB` (gzip ~`32.44 kB`)
  - `dist/assets/charts_vendor-*.js` ~`411.17 kB` (gzip ~`109.73 kB`)
  - `dist/assets/react_vendor-*.js` ~`160.84 kB` (gzip ~`52.53 kB`)
- Chunk-size warning: none (threshold warning eliminated).
- Dynamic-import/static-import conflict warning no longer present in current build output.

## New Guardrails Added

- Import-boundary regression tests: `/Users/sampatel/tali-platform/backend/tests/test_architecture_boundaries.py`
  - Blocks `api/v1` importing legacy `components/*/api.py` modules.
  - Blocks direct cross-domain repository imports.
  - Enforces that removed legacy API/shim/wrapper files remain absent.
- Domain ownership CODEOWNERS map: `/Users/sampatel/tali-platform/.github/CODEOWNERS`.
- Additional CI architecture gates: `/Users/sampatel/tali-platform/backend/tests/test_ci_architecture_gates.py`.
  - File-size gate now runs with an empty allowlist (no temporary service/route exceptions).
- Dead-code candidate report script: `/Users/sampatel/tali-platform/scripts/dead_code_candidates.py`.
